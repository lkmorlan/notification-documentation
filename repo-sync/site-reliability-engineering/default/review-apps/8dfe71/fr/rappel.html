<!DOCTYPE html>
<html lang="fr-CA">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Fonctions de rappel | Notification GC</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="shortcut icon" href="https://notification.canada.ca/static/images/favicon.ico">
    <meta name="description" content="Intégration directe à l`API Notification GC">
    <meta charset="utf-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/css/0.styles.d14a4897.css" as="style"><link rel="preload" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/app.1d39828b.js" as="script"><link rel="preload" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/3.1b1897ca.js" as="script"><link rel="preload" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/2.d0b1196e.js" as="script"><link rel="preload" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/28.ef92634a.js" as="script"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/10.18c618c4.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/11.23c96123.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/12.7519e4d4.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/13.090f3a0b.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/14.c9ccbc84.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/15.4f75b3f5.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/16.e49a106e.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/17.74bd9318.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/18.8e8196da.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/19.a5ad136c.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/20.103ae8cf.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/21.8edecf72.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/22.47e39bb4.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/23.bd2e88c5.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/24.b9a62022.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/25.acc12fb4.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/26.9bf85283.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/27.aa8eee99.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/29.65cd3090.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/4.4f1111b5.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/5.d4600513.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/6.32886ebf.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/7.85b49c97.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/8.e3ca1ce3.js"><link rel="prefetch" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/9.0105dbd6.js">
    <link rel="stylesheet" href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/css/0.styles.d14a4897.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/" class="home-link router-link-active"><img src="https://assets.notification.canada.ca/static/gov-canada-fr.svg" alt="Notification GC" class="logo"> <div class="site-name can-hide">Notification GC</div> <div class="site-subtitle">Documentation API</div></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide nav-links"><div class="nav-item"><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/en/" class="nav-link">
  English
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/en/" class="nav-link">
  English
</a></div> <!----></nav> <div class="back-to-notify"><a href="https://notification.canada.ca?lang=fr" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Retour à Notification GC
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <ul class="sidebar-links"><li><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/" aria-current="page" class="sidebar-link">Intégrer l’API</a></li><li><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/commencer.html" class="sidebar-link">Pour commencer</a></li><li><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/envoyer.html" class="sidebar-link">Envoyer un message</a></li><li><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/etat.html" class="sidebar-link">Obtenir l’état du message</a></li><li><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/essai.html" class="sidebar-link">Mise à l’essai</a></li><li><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/cles.html" class="sidebar-link">Clés API</a></li><li><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/limites.html" class="sidebar-link">Limites</a></li><li><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/rappel.html" aria-current="page" class="active sidebar-link">Fonctions de rappel</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/rappel.html#configurer-des-fonctions-de-rappel" class="sidebar-link">Configurer des fonctions de rappel</a></li><li class="sidebar-sub-header"><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/rappel.html#accuses-de-reception-de-message" class="sidebar-link">Accusés de réception de message</a></li></ul></li><li><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/architecture.html" class="sidebar-link">Architecture API</a></li><li><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/clients.html" class="sidebar-link">Bibliothèques client</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="fonctions-de-rappel"><a href="#fonctions-de-rappel" class="header-anchor">#</a> Fonctions de rappel</h1> <p>Les fonctions de rappels peuvent automatiser la production d'un accusé de réception ou maintenir l'état d'une notification dans votre base de données.</p> <p>Une fonction de rappel vous permet de recevoir des messages sur l'état des notifications de Notification GC à une adresse URL de votre choix. Les rappels sont lorsque Notification GC envoie des requêtes HTTP <code>POST</code> à votre service. Vous pouvez obtenir des rappels lorsqu'un courriel ou un message texte que vous avez envoyé est livré ou échoue.</p> <p>Vous devrez fournir un jeton <code>Bearer</code>, pour des raisons de sécurité. Nous ajouterons ceci à l’en-tête <code>Authorization</code> de la demande de rappel.</p> <h2 id="configurer-des-fonctions-de-rappel"><a href="#configurer-des-fonctions-de-rappel" class="header-anchor">#</a> Configurer des fonctions de rappel</h2> <p>Vous devez fournir :</p> <ul><li>une adresse URL de destination vers laquelle Notification GC effectuera une requête HTTP</li> <li>un jeton <code>Bearer</code>, pour des raisons de sécurité, que Notification GC placera dans l’en-tête <code>Authorization</code> des demandes</li></ul> <p>Pour ce faire :</p> <ol><li><a href="https://notification.canada.ca/sign-in?lang=fr" target="_blank" rel="noopener noreferrer">Connectez-vous à Notification GC<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li>Allez à la page <strong>Intégration API</strong>.</li> <li>Sélectionnez <strong>Fonctions de rappel</strong>.</li></ol> <p>Lors de la création d’un jeton <code>Bearer</code>, vous devez :</p> <ul><li>garder votre jeton <code>Bearer</code> sécurisé</li> <li>le changer si vous avez une raison de penser qu’on ne peut plus lui faire confiance</li> <li>Assurez-vous que les fonctions de rappel que vous recevez de Notification GC contiennent votre jeton <code>Bearer</code> dans l’en-tête <code>Authorization</code></li> <li>utiliser une valeur hachée pour que Notification GC ne contienne pas le vrai jeton</li></ul> <h2 id="accuses-de-reception-de-message"><a href="#accuses-de-reception-de-message" class="header-anchor">#</a> Accusés de réception de message</h2> <p>Lorsque vous envoyez un courriel ou un message texte, Notification GC envoie un accusé de réception à votre adresse URL de rappel pour vous dire s’il a été livré ou non. Il s’agit d’une méthode automatisée pour obtenir l’état des messages.</p> <p>Cette fonctionnalité fonctionne avec les clés API de test, mais ne fonctionne pas avec les adresses de courriel ou les numéros de téléphone de test de détection de fumée.</p> <p>Le message de la fonction de rappel est formaté en JSON. Toutes les valeurs sont des chaînes de caractères. Voici la clé, la description et le format des arguments du message de la fonction de rappel :</p> <table><thead><tr><th style="text-align:left;">Clé</th> <th style="text-align:left;">Description</th> <th style="text-align:left;">Format de la chaîne</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>id</code></td> <td style="text-align:left;">ID de Notification GC pour les accusés d’état</td> <td style="text-align:left;">UUID</td></tr> <tr><td style="text-align:left;"><code>reference</code></td> <td style="text-align:left;">Référence envoyée par le service</td> <td style="text-align:left;">12345678</td></tr> <tr><td style="text-align:left;"><code>to</code></td> <td style="text-align:left;">L’adresse de courriel ou numéro de téléphone du destinataire</td> <td style="text-align:left;">hello@canada.ca ou 01234567890</td></tr> <tr><td style="text-align:left;"><code>status</code></td> <td style="text-align:left;">État de la notification</td> <td style="text-align:left;"><code>delivered</code>, <code>permanent-failure</code>, <code>temporary-failure</code> ou <code>technical-failure</code></td></tr> <tr><td style="text-align:left;"><code>provider_response</code></td> <td style="text-align:left;">La réponse détaillée venant du fournisseur. Ceci sera renseigné uniquement lorsque l’état de la notification est une erreur technique</td> <td style="text-align:left;"><code>Blocked as spam by phone carrier</code> (ou tout autre message) ou nul</td></tr> <tr><td style="text-align:left;"><code>created_at</code></td> <td style="text-align:left;">Heure à laquelle le service a envoyé la demande</td> <td style="text-align:left;"><code>2017-05-14T12:15:30.000000Z</code></td></tr> <tr><td style="text-align:left;"><code>completed_at</code></td> <td style="text-align:left;">Dernière mise à jour de l’état</td> <td style="text-align:left;"><code>2017-05-14T12:15:30.000000Z</code> ou nul</td></tr> <tr><td style="text-align:left;"><code>sent_at</code></td> <td style="text-align:left;">Heure d’envoi de la notification</td> <td style="text-align:left;"><code>2017-05-14T12:15:30.000000Z</code> ou nul</td></tr> <tr><td style="text-align:left;"><code>notification_type</code></td> <td style="text-align:left;">Type de notification</td> <td style="text-align:left;"><code>email</code> ou <code>sms</code></td></tr></tbody></table> <div class="custom-block warning"><p class="custom-block-title">Plusieurs fonctions de rappel pour une notification</p> <p>Vous pouvez recevoir plusieurs fonctions de rappel pour une seule notification envoyée. Par exemple, il est possible que le serveur de messagerie destinataire accepte le courriel (envoyant une fonction de rappel de livraison réussie), mais après avoir traité le courriel, le serveur de messagerie peut déterminer qu’en réalité ce courriel retourne un échec (envoyant une fonction de rappel d’échec).</p> <p>Les fonctions de rappel sont envoyées dans l’ordre où elles sont reçues.</p></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/cds-snc/notification-documentation/edit/main/src/fr/rappel.md" target="_blank" rel="noopener noreferrer">Modifier cette page sur GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Dernière mise à jour :</span> <span class="time">2023-01-13</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/limites.html" class="prev">
        Limites
      </a></span> <span class="next"><a href="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/fr/architecture.html">
        Architecture API
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/app.1d39828b.js" defer></script><script src="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/3.1b1897ca.js" defer></script><script src="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/2.d0b1196e.js" defer></script><script src="/notification-documentation/repo-sync/site-reliability-engineering/default/review-apps/8dfe71/assets/js/28.ef92634a.js" defer></script>
  </body>
</html>
